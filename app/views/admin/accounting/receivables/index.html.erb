<div class="space-y-6">
  <div class="flex justify-between items-center">
    <div><h1 class="text-2xl font-bold">売上・債権管理</h1><p class="text-sm text-gray-500">請求・入金照合・滞留債権管理</p></div>
    <div class="flex gap-2">
      <button class="btn-secondary text-sm">入金照合</button>
      <button class="btn-secondary text-sm">督促メール</button>
      <button class="btn-primary text-sm">CSV出力</button>
    </div>
  </div>
  <div class="grid grid-cols-2 gap-4 sm:grid-cols-5">
    <div class="card p-4 bg-gradient-to-br from-blue-500 to-blue-600 text-white"><p class="text-xs text-blue-100">総売上</p><p class="mt-2 text-xl font-bold"><%= number_to_currency(@summary[:total_sales], unit: "¥", precision: 0, delimiter: ",") %></p></div>
    <div class="card p-4 bg-gradient-to-br from-orange-500 to-orange-600 text-white"><p class="text-xs text-orange-100">未入金額</p><p class="mt-2 text-xl font-bold"><%= number_to_currency(@summary[:outstanding_amount], unit: "¥", precision: 0, delimiter: ",") %></p></div>
    <div class="card p-4 bg-gradient-to-br from-red-500 to-red-600 text-white"><p class="text-xs text-red-100">滞留額</p><p class="mt-2 text-xl font-bold"><%= number_to_currency(@summary[:overdue_amount], unit: "¥", precision: 0, delimiter: ",") %></p></div>
    <div class="card p-4"><p class="text-xs text-gray-500">平均回収日数</p><p class="mt-2 text-3xl font-bold text-blue-600"><%= @summary[:average_collection_days] %>日</p></div>
    <div class="card p-4"><p class="text-xs text-gray-500">回収率</p><p class="mt-2 text-3xl font-bold text-green-600"><%= @summary[:collection_rate] %>%</p></div>
  </div>
  <div class="bg-white rounded-xl shadow-sm overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50"><tr>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">請求番号</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">クライアント</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">案件</th>
        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">請求額</th>
        <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">請求日</th>
        <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">期限</th>
        <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">入金日</th>
        <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">経過日数</th>
        <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">ステータス</th>
      </tr></thead>
      <tbody class="divide-y divide-gray-200">
        <% @receivables.each do |rec| %>
        <tr class="hover:bg-gray-50 <%= 'bg-red-50' if rec[:alert] %>">
          <td class="px-6 py-4 text-sm font-medium"><%= rec[:invoice_number] %></td>
          <td class="px-6 py-4 text-sm"><%= rec[:client] %></td>
          <td class="px-6 py-4 text-sm"><%= rec[:project] %></td>
          <td class="px-6 py-4 text-sm text-right font-bold"><%= number_to_currency(rec[:total], unit: "¥", precision: 0, delimiter: ",") %></td>
          <td class="px-6 py-4 text-sm text-center"><%= rec[:invoice_date] %></td>
          <td class="px-6 py-4 text-sm text-center"><%= rec[:due_date] %></td>
          <td class="px-6 py-4 text-sm text-center"><%= rec[:payment_date] || '-' %></td>
          <td class="px-6 py-4 text-sm text-center <%= rec[:alert] ? 'text-red-600 font-bold' : '' %>"><%= rec[:days_outstanding] > 0 ? "#{rec[:days_outstanding]}日" : '-' %></td>
          <td class="px-6 py-4 text-center">
            <% case rec[:status] %>
            <% when "未入金" %><span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">未入金</span>
            <% when "入金済" %><span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">入金済</span>
            <% when "滞留" %><span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">滞留</span>
            <% end %>
          </td>
        </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
